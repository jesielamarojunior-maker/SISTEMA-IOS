<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instituto da Oportunidade Social - Sistema de Chamada</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <i class="fas fa-graduation-cap"></i>
                <h2>IOS</h2>
                <p>Instituto da Oportunidade Social</p>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" required>
                </div>
                <div class="form-group">
                    <label for="userType">Tipo de usu√°rio</label>
                    <select id="userType" required>
                        <option value="">Selecione...</option>
                        <option value="admin">Administrador Master</option>
                        <option value="instructor">Instrutor</option>
                        <option value="pedagogue">Pedagogo</option>
                        <option value="monitor">Monitor</option>
                    </select>
                </div>
                <button type="submit" class="btn-login">
                    Entrar no sistema
                </button>
                <div style="display: flex; justify-content: center; margin-top: 10px;">
                    <button type="button" class="btn" id="btnPrimeiroAcesso" style="padding: 6px 24px; font-size: 0.95rem; min-width: 120px;">
                        Primeiro Acesso
                    </button>
                </div>
            </form>
            <div id="loginAlert" class="alert alert-error hidden">
                Credenciais inv√°lidas! Tente novamente.
            </div>
            <div class="test-users">
                <strong>Usu√°rios de Teste:</strong><br>
                Admin: admin@ios.org.br / admin123<br>
                Instrutor: instrutor@ios.org.br / inst123<br>
                Pedagogo: pedagogo@ios.org.br / ped123<br>
                Monitor: monitor@ios.org.br / mon123
            </div>
        </div>
    </div>
    <div id="mainSystem" class="container hidden">
        <div class="header">
            <div class="logo">
                <div>
                    <h1><i class="fas fa-graduation-cap"></i> Instituto da Oportunidade Social</h1>
                    <div class="subtitle">Sistema de Controle de Presen√ßa</div>
                </div>
            </div>
            <div id="userInfo" class="user-info">
                <div class="user-avatar" id="userAvatar"></div>
                <div>
                    <div id="userDisplayName" style="font-weight: 600;"></div>
                    <div id="userDisplayRole" style="color: #718096; font-size: 0.9rem;"></div>
                </div>
                <button class="btn btn-danger" onclick="logout()" style="margin-left: auto;">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showPage('dashboard')">
                    <i class="fas fa-chart-pi"></i> Dashboard
                </button>
                <button class="nav-tab" onclick="showPage('users')" id="usersTab">
                    <i class="fas fa-user-plus"></i> Usu√°rios
                </button>
                <button class="nav-tab" onclick="showPage('units')" id="unitsTab">
                    <i class="fas fa-building"></i> Unidades
                </button>
                <button class="nav-tab" onclick="showPage('courses')" id="coursesTab">
                    <i class="fas fa-book"></i> Cursos
                </button>
                <button class="nav-tab" onclick="showPage('classes')">
                    <i class="fas fa-users"></i> Turmas
                </button>
                <button class="nav-tab" onclick="showPage('attendance')">
                    <i class="fas fa-check-circle"></i> Chamada
                </button>
                <button class="nav-tab" onclick="showPage('reports')" id="reportsTab">
                    <i class="fas fa-file-excel"></i> Relat√≥rios
                </button>
                <button class="nav-tab" onclick="showPage('data-management')" id="dataManagementTab">
                    <i class="fas fa-database"></i> Dados
                </button>
            </div>
        </div>
        <div class="content">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page active">
                <h2><i class="fas fa-chart-pi"></i> Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalUnits">0</div>
                        <div class="stat-label">Unidades</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalClasses">0</div>
                        <div class="stat-label">Turmas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalStudents">0</div>
                        <div class="stat-label">Estudantes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="todayAttendance">0</div>
                        <div class="stat-label">Presen√ßas Hoje</div>
                    </div>
                    <div class="stat-card" id="highestAttendanceCard" style="display: none;">
                        <div class="stat-number" id="highestAttendance">-</div>
                        <div class="stat-label">Maior Frequ√™ncia</div>
                    </div>
                    <div class="stat-card" id="highestAbsenceCard" style="display: none;">
                        <div class="stat-number" id="highestAbsence">-</div>
                        <div class="stat-label">Maior Faltas</div>
                    </div>
                    <div class="stat-card" id="dropoutsCard" style="display: none;">
                        <div class="stat-number" id="totalDropouts">0</div>
                        <div class="stat-label">Desistentes</div>
                    </div>
                </div>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i> Use o menu acima para navegar entre as funcionalidades.
                </div>
            </div>

            <!-- Users Management Page -->
            <div id="usersPage" class="page">
                <h2><i class="fas fa-user-plus"></i> Gerenciamento de Usu√°rios</h2>
                <form id="userForm" style="margin-bottom: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label for="userName">Nome Completo</label>
                            <input type="text" id="userName" required>
                        </div>
                        <div class="form-group">
                            <label for="userCpf">CPF</label>
                            <input type="text" id="userCpf" required maxlength="14" placeholder="000.000.000-00">
                        </div>
                        <div class="form-group">
                            <label for="userEmailCreate">E-mail Institucional</label>
                            <input type="email" id="userEmailCreate" required placeholder="@ios.org.br">
                        </div>
                        <div class="form-group">
                            <label for="userPassword">Senha Tempor√°ria</label>
                            <input type="password" id="userPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="userRole">Tipo de Usu√°rio</label>
                            <select id="userRole" required>
                                <option value="">Selecione...</option>
                                <option value="admin">Administrador Master</option>
                                <option value="instructor">Instrutor</option>
                                <option value="pedagogue">Pedagogo</option>
                                <option value="monitor">Monitor</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="userUnit">Unidade (apenas para n√£o-admin)</label>
                            <select id="userUnit">
                                <option value="">Selecione...</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-plus"></i> Cadastrar Usu√°rio
                    </button>
                    
                    <!-- Bot√£o de teste e diagn√≥stico (pode ser removido em produ√ß√£o) -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(255, 193, 7, 0.1); border-radius: 8px; display: none;" id="testSection">
                        <small style="color: #856404; font-weight: 500;">üß™ Ferramentas de Diagn√≥stico:</small><br>
                        <button type="button" onclick="diagnosticoCompleto()" class="btn" style="margin: 5px 5px 0 0; font-size: 0.8rem; padding: 5px 10px;">
                            üîç Diagn√≥stico
                        </button>
                        <button type="button" onclick="testarCadastroCompleto()" class="btn" style="margin: 5px 5px 0 0; font-size: 0.8rem; padding: 5px 10px;">
                            üß™ Teste Cadastro
                        </button>
                        <button type="button" onclick="document.getElementById('testSection').style.display='none'" class="btn" style="margin: 5px 5px 0 0; font-size: 0.8rem; padding: 5px 10px;">
                            ‚ùå Fechar
                        </button>
                    </div>
                    
                    <!-- Mostrar bot√£o de teste apenas se pressionado Ctrl+Shift+T -->
                    <script>
                        document.addEventListener('keydown', function(e) {
                            if (e.ctrlKey && e.shiftKey && e.key === 'T') {
                                const testSection = document.getElementById('testSection');
                                testSection.style.display = testSection.style.display === 'none' ? 'block' : 'none';
                                e.preventDefault();
                            }
                        });
                    </script>
                </form>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>CPF</th>
                            <th>E-mail</th>
                            <th>Tipo</th>
                            <th>Unidade</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody"></tbody>
                </table>
            </div>
            <div id="unitsPage" class="page">
                <h2><i class="fas fa-building"></i> Gerenciamento de Unidades</h2>
                <form id="unitForm" style="margin-bottom: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="form-group"><label for="unitName">Nome da Unidade</label><input type="text" id="unitName" required></div>
                        <div class="form-group"><label for="unitAddress">Endere√ßo</label><input type="text" id="unitAddress" required></div>
                        <div class="form-group"><label for="unitPhone">Telefone</label><input type="tel" id="unitPhone" required></div>
                    </div>
                    <button type="submit" class="btn btn-success"><i class="fas fa-plus"></i> Cadastrar Unidade</button>
                </form>
                <table class="table"><thead><tr><th>Unidade</th><th>Telefone</th><th>Cursos & Turmas</th><th>A√ß√µes</th></tr></thead><tbody id="unitsTableBody"></tbody></table>
            </div>
            <div id="classesPage" class="page">
                <h2><i class="fas fa-users"></i> Gerenciamento de Turmas</h2>
                <form id="classForm" style="margin-bottom: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div class="form-group"><label for="className">Nome da Turma</label><input type="text" id="className" required></div>
                        <div class="form-group"><label for="classUnit">Unidade</label><select id="classUnit" required onchange="loadCoursesForUnit()"><option value="">Selecione...</option></select></div>
                        <div class="form-group"><label for="classCourse">Curso</label><select id="classCourse" required><option value="">Selecione uma unidade primeiro...</option></select></div>
                        <div class="form-group"><label for="classInstructor">Instrutor</label><input type="text" id="classInstructor" required></div>
                        <div class="form-group"><label for="classYear">Ano</label><input type="number" id="classYear" required></div>
                        <div class="form-group">
                            <label for="classCiclo">Ciclo</label>
                            <input type="text" id="classCiclo" required placeholder="Ex: 01/2025">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success"><i class="fas fa-plus"></i> Cadastrar Turma</button>
                </form>
                <div style="margin-bottom: 20px;">
                    <h3>Adicionar Estudantes</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="studentClass">Turma</label>
                            <select id="studentClass"><option value="">Selecione uma turma</option></select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="studentName">Nome do Estudante</label>
                            <input type="text" id="studentName" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="studentCpf">CPF</label>
                            <input type="text" id="studentCpf" required maxlength="14" placeholder="000.000.000-00">
                        </div>
                        <button type="button" onclick="addStudent()" class="btn"><i class="fas fa-user-plus"></i> Adicionar</button>
                    </div>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Turma</th>
                            <th>Unidade</th>
                            <th>Curso</th>
                            <th>Ciclo</th>
                            <th>Instrutor</th>
                            <th>Ano</th>
                            <th>Estudantes</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="classesTableBody"></tbody>
                </table>
            </div>
            <div id="attendancePage" class="page">
                <h2><i class="fas fa-check-circle"></i> Registro de Presen√ßa</h2>
                <div style="display: flex; gap: 20px; align-items: end; margin-bottom: 30px;">
                    <div class="form-group" style="flex: 1; margin-bottom: 0;">
                        <label for="attendanceClass">Selecionar Turma</label>
                        <select id="attendanceClass" onchange="loadAttendanceStudents()">
                            <option value="">Selecione uma turma</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label for="attendanceDate">Data</label>
                        <input type="date" id="attendanceDate" onchange="loadAttendanceStudents()">
                    </div>
                    <button onclick="saveAttendance()" class="btn btn-success">
                        <i class="fas fa-save"></i> Salvar Presen√ßa
                    </button>
                    <button onclick="exportAttendanceSheet()" class="btn btn-primary">
                        <i class="fas fa-file-excel"></i> Exportar Lista
                    </button>
                </div>
                <div id="attendanceStudents" class="attendance-grid">
                    <div class="alert alert-info">Selecione uma turma e data para come√ßar o registro de presen√ßa.</div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reportsPage" class="page">
                <h2><i class="fas fa-file-excel"></i> Relat√≥rios de Presen√ßa</h2>
                <div class="report-filters" style="margin-bottom: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label for="reportUnit">Unidade</label>
                            <select id="reportUnit" onchange="loadReportClasses()">
                                <option value="">Todas as unidades</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reportClass">Turma</label>
                            <select id="reportClass">
                                <option value="">Todas as turmas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reportDateStart">Data Inicial</label>
                            <input type="date" id="reportDateStart">
                        </div>
                        <div class="form-group">
                            <label for="reportDateEnd">Data Final</label>
                            <input type="date" id="reportDateEnd">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button onclick="generateReport()" class="btn">
                            <i class="fas fa-chart-bar"></i> Gerar Relat√≥rio
                        </button>
                        <button onclick="exportToExcel()" class="btn btn-success">
                            <i class="fas fa-file-excel"></i> Exportar para Excel
                        </button>
                    </div>
                </div>
                <div id="reportResults"></div>
            </div>

            <!-- Data Management Page -->
            <div id="dataManagementPage" class="page">
                <h2><i class="fas fa-database"></i> Gerenciamento de Dados</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="dataStorageSize">0 KB</div>
                        <div class="stat-label">Espa√ßo Usado</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="lastSaveTime">-</div>
                        <div class="stat-label">√öltimo Salvamento</div>
                    </div>
                </div>

                <div class="data-actions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px;">
                    
                    <!-- Backup e Restore -->
                    <div class="report-card">
                        <div class="report-header">
                            <h3><i class="fas fa-download"></i> Backup & Restore</h3>
                        </div>
                        <p style="color: #64748b; margin-bottom: 20px;">
                            Fa√ßa backup de todos os dados ou restaure de um arquivo anterior.
                        </p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-success" onclick="exportDataBackup()">
                                <i class="fas fa-download"></i> Exportar Backup
                            </button>
                            <label class="btn" style="cursor: pointer; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <i class="fas fa-upload"></i> Importar Backup
                                <input type="file" accept=".json" onchange="importDataBackup(this)" style="display: none;">
                            </label>
                        </div>
                    </div>

                    <!-- Status do Sistema -->
                    <div class="report-card">
                        <div class="report-header">
                            <h3><i class="fas fa-info-circle"></i> Status do Sistema</h3>
                        </div>
                        <div id="systemStatus">
                            <div style="margin-bottom: 10px;">
                                <strong>Auto-save:</strong> <span id="autoSaveStatus" style="color: #48bb78;">Ativo</span>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <strong>Total de registros:</strong>
                                <div style="margin-left: 20px; margin-top: 5px;">
                                    <div>Usu√°rios: <span id="usersCount">0</span></div>
                                    <div>Unidades: <span id="unitsCount">0</span></div>
                                    <div>Cursos: <span id="coursesCount">0</span></div>
                                    <div>Turmas: <span id="classesCount">0</span></div>
                                    <div>Estudantes: <span id="studentsCount">0</span></div>
                                    <div>Registros de presen√ßa: <span id="attendanceCount">0</span></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- A√ß√µes Administrativas -->
                    <div class="report-card">
                        <div class="report-header">
                            <h3><i class="fas fa-tools"></i> A√ß√µes Administrativas</h3>
                        </div>
                        <p style="color: #64748b; margin-bottom: 20px;">
                            <strong>‚ö†Ô∏è CUIDADO:</strong> Estas a√ß√µes s√£o irrevers√≠veis!
                        </p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-danger" onclick="clearAllSystemData()">
                                <i class="fas fa-trash"></i> Limpar Todos os Dados
                            </button>
                            <button class="btn" onclick="saveDataManually()" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">
                                <i class="fas fa-save"></i> Salvar Agora
                            </button>
                            <button class="btn" onclick="forcarAtualizacaoDados()" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                                <i class="fas fa-sync-alt"></i> Atualizar Dados
                            </button>
                            <button class="btn" onclick="atualizarDadosForcado()" style="background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);">
                                <i class="fas fa-hammer"></i> For√ßar Atualiza√ß√£o
                            </button>
                            <button class="btn" onclick="mostrarDadosEmergencia()" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);">
                                <i class="fas fa-exclamation-triangle"></i> Modo Emerg√™ncia
                            </button>
                        </div>
                    </div>
                </div>

                <div class="report-card" style="margin-top: 20px;">
                    <div class="report-header">
                        <h3><i class="fas fa-question-circle"></i> Sobre o Armazenamento Local</h3>
                    </div>
                    <div style="color: #64748b; line-height: 1.6;">
                        <p><strong>Como funciona:</strong> Os dados s√£o salvos automaticamente no seu navegador usando localStorage. Isso significa que:</p>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li>‚úÖ Dados persistem entre sess√µes (n√£o s√£o perdidos ao fechar o navegador)</li>
                            <li>‚úÖ Salvamento autom√°tico a cada 2 minutos e sempre que voc√™ faz altera√ß√µes</li>
                            <li>‚úÖ Funciona offline - n√£o precisa de conex√£o com internet</li>
                            <li>‚ö†Ô∏è Dados ficam apenas neste computador e navegador</li>
                            <li>‚ö†Ô∏è Limpar dados do navegador apagar√° todas as informa√ß√µes</li>
                        </ul>
                        <p><strong>Recomenda√ß√£o:</strong> Fa√ßa backups regulares para ter uma c√≥pia de seguran√ßa dos dados.</p>
                    </div>
                </div>
            </div>

            <!-- Courses Page -->
            <div id="coursesPage" class="page">
                <h2><i class="fas fa-book"></i> Gerenciamento de Cursos</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCourses">0</div>
                        <div class="stat-label">Total de Cursos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeCourses">0</div>
                        <div class="stat-label">Cursos Ativos</div>
                    </div>
                </div>

                <form id="courseForm" style="margin-bottom: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label for="courseName">Nome do Curso</label>
                            <input type="text" id="courseName" placeholder="Ex: Inform√°tica B√°sica" required>
                        </div>
                        <div class="form-group">
                            <label for="courseDescription">Descri√ß√£o</label>
                            <textarea id="courseDescription" placeholder="Descri√ß√£o do curso..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="courseDuration">Dura√ß√£o (horas)</label>
                            <input type="number" id="courseDuration" placeholder="120" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="courseUnit">Unidade</label>
                            <select id="courseUnit" required>
                                <option value="">Selecione uma unidade...</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Cadastrar Curso
                        </button>
                        <button type="button" class="btn" onclick="cancelCourseEdit()" id="cancelCourseEdit" style="display: none;">
                            <i class="fas fa-times"></i> Cancelar Edi√ß√£o
                        </button>
                    </div>
                </form>

                <div class="report-card">
                    <div class="report-header">
                        <h3><i class="fas fa-list"></i> Cursos Cadastrados</h3>
                        <div>
                            <label for="filterCourseUnit" style="margin-right: 10px;">Filtrar por unidade:</label>
                            <select id="filterCourseUnit" onchange="loadCourses()">
                                <option value="">Todas as unidades</option>
                            </select>
                        </div>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nome do Curso</th>
                                <th>Unidade</th>
                                <th>Dura√ß√£o</th>
                                <th>Status</th>
                                <th>Turmas</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="coursesTableBody">
                            <!-- Courses will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Primeiro Acesso -->
    <style>
/* Modal overlay */
#primeiroAcessoModal.modal {
    position: fixed;
    z-index: 9999;
    left: 0; top: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.45);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.2s;
}
#primeiroAcessoModal .modal-content {
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    padding: 32px 28px 18px 28px;
    width: 100%;
    max-width: 370px;
    position: relative;
    animation: fadeInModal 0.3s;
}
@keyframes fadeInModal {
    from { opacity: 0; transform: translateY(-30px);}
    to   { opacity: 1; transform: translateY(0);}
}
#primeiroAcessoModal .close {
    position: absolute;
    right: 18px;
    top: 14px;
    font-size: 1.3rem;
    color: #888;
    cursor: pointer;
    transition: color 0.2s;
}
#primeiroAcessoModal .close:hover {
    color: #e53e3e;
}
#primeiroAcessoModal h3 {
    text-align: center;
    font-size: 1.25rem;
    font-weight: 700;
    margin-bottom: 22px;
    color: #22223b;
    letter-spacing: 0.01em;
}
#primeiroAcessoModal .form-group {
    margin-bottom: 16px;
}
#primeiroAcessoModal label {
    font-size: 0.97rem;
    color: #22223b;
    font-weight: 500;
    margin-bottom: 4px;
    display: block;
}
#primeiroAcessoModal input,
#primeiroAcessoModal select {
    width: 100%;
    padding: 9px 12px;
    border: 1px solid #d1d5db;
    border-radius: 7px;
    font-size: 1rem;
    background: #f8fafc;
    margin-top: 2px;
    transition: border 0.2s;
}
#primeiroAcessoModal input:focus,
#primeiroAcessoModal select:focus {
    border-color: #3182ce;
    outline: none;
    background: #fff;
}
#primeiroAcessoModal button[type="submit"] {
    margin-top: 10px;
    width: 100%;
    background: linear-gradient(90deg, #38a169 0%, #319795 100%);
    color: #fff;
    font-weight: 700;
    font-size: 1.05rem;
    border: none;
    border-radius: 8px;
    padding: 11px 0;
    letter-spacing: 0.04em;
    box-shadow: 0 2px 8px rgba(56,161,105,0.08);
    transition: background 0.2s;
}
#primeiroAcessoModal button[type="submit"]:hover {
    background: linear-gradient(90deg, #319795 0%, #38a169 100%);
}
@media (max-width: 480px) {
    #primeiroAcessoModal .modal-content {
        padding: 18px 6vw 12px 6vw;
        max-width: 98vw;
    }
}
</style>
<div id="primeiroAcessoModal" class="modal hidden">
    <div class="modal-content">
        <span class="close" onclick="fecharPrimeiroAcesso()">&times;</span>
        <h3>Primeiro Acesso</h3>
        <form id="primeiroAcessoForm" autocomplete="off">
            <div class="form-group">
                <label for="novoNome">Nome Completo</label>
                <input type="text" id="novoNome" required maxlength="60" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="novoApelido">Apelido</label>
                <input type="text" id="novoApelido" required maxlength="30" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="novoEmail">E-mail</label>
                <input type="email" id="novoEmail" required maxlength="60" autocomplete="off" placeholder="nome@ios.org.br">
            </div>
            <div class="form-group">
                <label for="novoSenha">Senha</label>
                <input type="password" id="novoSenha" required minlength="6" maxlength="32" autocomplete="new-password" placeholder="M√≠nimo 6 caracteres">
            </div>
            <div class="form-group">
                <label for="novoUnidade">Unidade</label>
                <select id="novoUnidade" required>
                    <option value="">Selecione...</option>
                </select>
            </div>
            <button type="submit" class="btn btn-success">Cadastrar</button>
        </form>
    </div>
</div>
    <script src="main.js"></script>
    <script src="advanced-functions.js"></script>
    <script>
        // Modal de primeiro acesso
        document.getElementById('btnPrimeiroAcesso').onclick = function() {
            document.getElementById('primeiroAcessoModal').classList.remove('hidden');
            carregarUnidadesPrimeiroAcesso();
        };
        function fecharPrimeiroAcesso() {
            document.getElementById('primeiroAcessoModal').classList.add('hidden');
        }
        function carregarUnidadesPrimeiroAcesso() {
            var select = document.getElementById('novoUnidade');
            select.innerHTML = '<option value="">Selecione...</option>';
            if (window.units && Array.isArray(window.units)) {
                window.units.forEach(function(unit) {
                    var opt = document.createElement('option');
                    opt.value = unit.id;
                    opt.textContent = unit.name;
                    select.appendChild(opt);
                });
            }
        }
        document.getElementById('primeiroAcessoForm').onsubmit = function(e) {
            e.preventDefault();
            cadastrarPrimeiroAcesso();
        };
    </script>
</body>
</html>